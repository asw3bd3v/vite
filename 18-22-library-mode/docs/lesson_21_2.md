# Сторонние зависимости в собственных библиотеках

Но т.к. размер файла библиотеки был увеличен за счет импорта сторонней библиотеки сконфигурируем vite нужным образом, чтобы код сторонних библиотек не включался в итоговые сборки.

```js
// lib/vite.config.js
export default {
    plugins: [Inspect()],
    build: {
        lib: {
            entry: [
                resolve(__dirname, 'src/index.js'),
                resolve(__dirname, 'src/log.js'),
            ],
            name: 'Pluck', // название библиотеки
            fileName: (format, name) => {
                if (format === 'es') {
                    return `${name}.js`;
                }

                return `${name}.${format}`;
            },
        },
        rollupOptions: {
            external: [ // указываем имена библиотек, которые не нужно включать в сборку
                'collect.js',
            ]
        }
    }
};
```

Теперь после сборки файлы библиотеки не содержат код collect.js.

Теперь удалим пакет collect.js.

```
npm uninstall collect.js
```

Но если проверить код клиентского приложения, то мы можем увидеть, что он работает, несмотря на то, что библиотека collect.js была удалена. Это происходит из-за того, что она была закэширована в app/node_modules/.vite/deps. Теперь если удалим данную папку, то в этом случае код работать не будет.

Поэтому в клиентском приложении установим данную библиотеку.

```
npm install collect.js
```

После этого получим другую ошибку, что зависимости (см. логи в консоли) не могут быть импортированы.

Еще раз выполним команду

```
npm link pluck
```

Но даже после этого мы получим ошибку о невозможности импорта библиотеки collect.js. Данную проблему решим в следующем уроке.